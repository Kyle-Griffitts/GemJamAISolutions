@page "/analysis"
@using GemJamAISolutions.Client.Services
@inject AuthService AuthService
@inject NavigationManager Navigation

<PageTitle>FloodReady AI - Risk Analysis</PageTitle>

<div class="analysis-container min-vh-100 py-4 py-md-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10 col-xl-9">
                <!-- Header -->
                <div class="d-flex align-items-center justify-content-between mb-4 gap-2">
                    <div class="d-flex align-items-center gap-2">
                        <button class="btn btn-link text-white text-decoration-none p-2 btn-back" @onclick="GoBack">
                            <span class="fs-4">&larr;</span>
                        </button>
                        <h1 class="fs-3 fs-md-2 fw-bold text-white mb-0">Flood Risk Analysis</h1>
                    </div>
                    <button class="btn btn-light btn-sm rounded-3 fw-semibold d-none d-md-flex align-items-center gap-2" @onclick="GoToHeatmap">
                        üó∫Ô∏è View Heatmap <span>&rarr;</span>
                    </button>
                </div>

                <!-- Mobile Heatmap Button -->
                <div class="d-md-none mb-3">
                    <button class="btn btn-light w-100 rounded-3 fw-semibold d-flex align-items-center justify-content-center gap-2" @onclick="GoToHeatmap">
                        üó∫Ô∏è View Flood Risk Heatmap <span>&rarr;</span>
                    </button>
                </div>

                <!-- High Risk Alert -->
                <div class="bg-white rounded-4 shadow-lg p-3 p-md-4 mb-3">
                    <div class="d-flex align-items-start gap-3 mb-3">
                        <span class="fs-1">‚ö†Ô∏è</span>
                        <div class="flex-grow-1">
                            <h2 class="fs-4 fw-semibold text-danger mb-2">High Flood Risk Detected</h2>
                            <p class="text-dark mb-0">Your area has a <strong>78% flood risk</strong> based on current weather patterns, elevation data, and historical flood records.</p>
                        </div>
                    </div>
                    <div class="bg-danger bg-opacity-10 rounded-3 p-3">
                        <p class="small text-danger mb-2 fw-semibold">‚è∞ Immediate Action Recommended</p>
                        <p class="small text-dark mb-0">Heavy rainfall is forecasted within the next 24-48 hours. Consider evacuating to higher ground if flooding begins.</p>
                    </div>
                </div>

                <!-- Risk Factors -->
                <div class="bg-white rounded-4 shadow-lg p-3 p-md-4 mb-3">
                    <h3 class="fs-5 fw-semibold text-dark mb-3">Risk Factors</h3>
                    <div class="row g-3">
                        <div class="col-12 col-md-6">
                            <div class="bg-light rounded-3 p-3">
                                <div class="d-flex align-items-center justify-content-between mb-2">
                                    <span class="small fw-medium text-secondary">Elevation Level</span>
                                    <span class="badge bg-danger">High Risk</span>
                                </div>
                                <div class="progress mb-2" style="height: 8px;">
                                    <div class="progress-bar bg-danger" role="progressbar" style="width: 85%" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <p class="small text-muted mb-0">Your location is in a low-lying area prone to flooding</p>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="bg-light rounded-3 p-3">
                                <div class="d-flex align-items-center justify-content-between mb-2">
                                    <span class="small fw-medium text-secondary">Rainfall Forecast</span>
                                    <span class="badge bg-warning text-dark">Moderate</span>
                                </div>
                                <div class="progress mb-2" style="height: 8px;">
                                    <div class="progress-bar bg-warning" role="progressbar" style="width: 65%" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <p class="small text-muted mb-0">4-6 inches of rain expected in next 48 hours</p>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="bg-light rounded-3 p-3">
                                <div class="d-flex align-items-center justify-content-between mb-2">
                                    <span class="small fw-medium text-secondary">Drainage System</span>
                                    <span class="badge bg-danger">High Risk</span>
                                </div>
                                <div class="progress mb-2" style="height: 8px;">
                                    <div class="progress-bar bg-danger" role="progressbar" style="width: 75%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <p class="small text-muted mb-0">Drainage capacity may be overwhelmed</p>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="bg-light rounded-3 p-3">
                                <div class="d-flex align-items-center justify-content-between mb-2">
                                    <span class="small fw-medium text-secondary">Historical Data</span>
                                    <span class="badge bg-warning text-dark">Moderate</span>
                                </div>
                                <div class="progress mb-2" style="height: 8px;">
                                    <div class="progress-bar bg-warning" role="progressbar" style="width: 60%" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <p class="small text-muted mb-0">3 flood events in past 5 years</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Evacuation Centers -->
                <div class="bg-white rounded-4 shadow-lg p-3 p-md-4 mb-3">
                    <h3 class="fs-5 fw-semibold text-dark mb-3">üè¢ Nearby Evacuation Centers</h3>
                    <div class="list-group list-group-flush">
                        <div class="list-group-item px-0 py-3">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <div>
                                    <h4 class="fs-6 fw-semibold text-dark mb-1">Community Center - Main Street</h4>
                                    <p class="small text-secondary mb-1">üìç 0.8 miles away ‚Ä¢ 15 min walk</p>
                                </div>
                                <span class="badge bg-success">Open 24/7</span>
                            </div>
                            <p class="small text-muted mb-0">Capacity: 500 people ‚Ä¢ Shelter, food, medical aid available</p>
                        </div>
                        <div class="list-group-item px-0 py-3">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <div>
                                    <h4 class="fs-6 fw-semibold text-dark mb-1">High School Gymnasium</h4>
                                    <p class="small text-secondary mb-1">üìç 1.2 miles away ‚Ä¢ 20 min walk</p>
                                </div>
                                <span class="badge bg-success">Open 24/7</span>
                            </div>
                            <p class="small text-muted mb-0">Capacity: 800 people ‚Ä¢ Pet-friendly shelter available</p>
                        </div>
                        <div class="list-group-item px-0 py-3">
                            <div class="d-flex justify-content-between align-items-start mb-2">
                                <div>
                                    <h4 class="fs-6 fw-semibold text-dark mb-1">County Emergency Relief Center</h4>
                                    <p class="small text-secondary mb-1">üìç 2.5 miles away ‚Ä¢ 35 min walk</p>
                                </div>
                                <span class="badge bg-success">Open 24/7</span>
                            </div>
                            <p class="small text-muted mb-0">Full emergency services ‚Ä¢ Medical personnel on-site</p>
                        </div>
                    </div>
                </div>

                <!-- Sandbag Locations -->
                <div class="bg-white rounded-4 shadow-lg p-3 p-md-4 mb-3">
                    <h3 class="fs-5 fw-semibold text-dark mb-3">ü™® Sandbag Distribution Points</h3>
                    <div class="row g-3">
                        <div class="col-12 col-md-6">
                            <div class="bg-light rounded-3 p-3">
                                <h4 class="fs-6 fw-semibold text-dark mb-2">Fire Station #3</h4>
                                <p class="small text-secondary mb-2">üìç 0.5 miles away</p>
                                <p class="small text-muted mb-2">Free sandbags available (limit 25 per household)</p>
                                <span class="badge bg-info text-dark">Open: 8AM - 8PM</span>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="bg-light rounded-3 p-3">
                                <h4 class="fs-6 fw-semibold text-dark mb-2">Public Works Yard</h4>
                                <p class="small text-secondary mb-2">üìç 1.8 miles away</p>
                                <p class="small text-muted mb-2">Self-serve sandbag station (bring shovel)</p>
                                <span class="badge bg-info text-dark">Open 24/7</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Safety Tips -->
                <div class="bg-white rounded-4 shadow-lg p-3 p-md-4 mb-3">
                    <h3 class="fs-5 fw-semibold text-dark mb-3">‚úÖ Recommended Safety Actions</h3>
                    <div class="row g-3">
                        <div class="col-12 col-md-6">
                            <div class="d-flex gap-3">
                                <span class="text-success fs-4">‚úì</span>
                                <div>
                                    <h4 class="fs-6 fw-semibold text-dark mb-1">Prepare Emergency Kit</h4>
                                    <p class="small text-muted mb-0">Include water, food, medications, flashlight, batteries, first aid, important documents</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="d-flex gap-3">
                                <span class="text-success fs-4">‚úì</span>
                                <div>
                                    <h4 class="fs-6 fw-semibold text-dark mb-1">Move Valuables to Higher Ground</h4>
                                    <p class="small text-muted mb-0">Relocate important items to upper floors or elevated surfaces</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="d-flex gap-3">
                                <span class="text-success fs-4">‚úì</span>
                                <div>
                                    <h4 class="fs-6 fw-semibold text-dark mb-1">Turn Off Utilities If Flooding Begins</h4>
                                    <p class="small text-muted mb-0">Shut off electricity and gas to prevent hazards</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="d-flex gap-3">
                                <span class="text-success fs-4">‚úì</span>
                                <div>
                                    <h4 class="fs-6 fw-semibold text-dark mb-1">Stay Informed</h4>
                                    <p class="small text-muted mb-0">Monitor weather alerts and local emergency broadcasts</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="d-flex gap-3">
                                <span class="text-success fs-4">‚úì</span>
                                <div>
                                    <h4 class="fs-6 fw-semibold text-dark mb-1">Never Walk or Drive Through Flood Water</h4>
                                    <p class="small text-muted mb-0">6 inches of moving water can knock you down; 12 inches can carry away a vehicle</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="d-flex gap-3">
                                <span class="text-success fs-4">‚úì</span>
                                <div>
                                    <h4 class="fs-6 fw-semibold text-dark mb-1">Charge All Devices</h4>
                                    <p class="small text-muted mb-0">Keep phones and emergency devices fully charged</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Emergency Contacts -->
                <div class="bg-white rounded-4 shadow-lg p-3 p-md-4">
                    <h3 class="fs-5 fw-semibold text-dark mb-3">üìû Emergency Contacts</h3>
                    <div class="row g-3">
                        <div class="col-12 col-sm-6 col-md-4">
                            <div class="text-center p-3 bg-light rounded-3">
                                <p class="small fw-medium text-secondary mb-1">Emergency Services</p>
                                <p class="fs-5 fw-bold text-dark mb-0">911</p>
                            </div>
                        </div>
                        <div class="col-12 col-sm-6 col-md-4">
                            <div class="text-center p-3 bg-light rounded-3">
                                <p class="small fw-medium text-secondary mb-1">Non-Emergency</p>
                                <p class="fs-5 fw-bold text-dark mb-0">311</p>
                            </div>
                        </div>
                        <div class="col-12 col-sm-6 col-md-4">
                            <div class="text-center p-3 bg-light rounded-3">
                                <p class="small fw-medium text-secondary mb-1">Red Cross</p>
                                <p class="fs-5 fw-bold text-dark mb-0">1-800-733-2767</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private void GoBack()
    {
        Navigation.NavigateTo("/");
    }

    private void GoToHeatmap()
    {
        Navigation.NavigateTo("/heatmap");
    }
}
